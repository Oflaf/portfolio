<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Olaf M. | Projekty</title>
    
    <link rel="icon" href="img/use_/fav.png" type="image/png">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.bunny.net/css?family=HK+Grotesk:400,700" rel="stylesheet">
    <link href="https://fonts.cdnfonts.com/css/cascadia-code" rel="stylesheet">
    
    <link rel="stylesheet" href="work.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

    <style>
        body {
            overflow-x: hidden;
            min-height: 100vh;
        }

        body.stop-scrolling {
            overflow: hidden !important;
            height: 100vh;
        }

        .site-footer {
            background-color: #000;
            color: #fff;
            font-family: 'HK Grotesk', sans-serif;
            padding: 0 2vw 4rem 2vw;
            position: relative;
            z-index: 10;
        }

        .footer-divider {
            width: 100%;
            height: 1px;
            background-color: rgba(255, 255, 255, 0.2);
            margin-bottom: 3rem;
        }

        .footer-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: flex-start;
            gap: 3rem;
        }

        .footer-left {
            flex: 0 1 350px;
            max-width: 350px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .footer-cta {
            font-size: 0.95rem;
            line-height: 1.6;
            text-align: justify;
            margin-bottom: 2rem;
            opacity: 0.9;
            color: #d1d1d1;
        }

        .copyright {
            font-size: 0.7rem;
            opacity: 0.5;
            margin-top: auto;
            font-family: 'HK Grotesk', sans-serif;
        }

        .footer-right {
            flex: 0 1 auto; 
            display: grid;
            grid-template-columns: repeat(3, 250px); 
            gap: 4rem; 
            
            text-align: left;
        }

        .footer-col {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .footer-subject {
            font-family: 'HK Grotesk', sans-serif;
            font-weight: 500;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 0.5rem;
        }

        .footer-col a, .footer-col span {
            color: #fff;
            text-decoration: none;
            font-size: 0.95rem;
            transition: opacity 0.3s ease;
            line-height: 1.5;
            white-space: nowrap;
            cursor: none; 
        }

        .footer-col a:hover {
            opacity: 0.6;
        }

        .site-footer {
            background-color: #000;
        }
        body.light-mode-active .site-footer {
            background-color: #fcfcfc;
            color: #111;
        }
        body.light-mode-active .footer-divider {
            background-color: rgba(0, 0, 0, 0.15);
        }
        body.light-mode-active .footer-cta {
            color: #444;
        }
        body.light-mode-active .footer-subject {
            color: rgba(0, 0, 0, 0.5);
        }
        body.light-mode-active .footer-col a, 
        body.light-mode-active .footer-col span {
            color: #111;
        }
        body.light-mode-active .copyright {
            color: #666;
        }

        @media (max-width: 1024px) {
            .footer-right {
                gap: 2rem;
            }
        }

        @media (max-width: 768px) {
            .site-footer {
                padding-bottom: 2rem;
            }
            .footer-container {
                flex-direction: column;
                gap: 3rem;
            }
            .footer-left {
                max-width: 100%;
                flex: 1 1 auto;
            }
            .footer-right {
                width: 100%;
                grid-template-columns: 1fr;
                gap: 2.5rem;
            }
            .footer-col a, .footer-col span {
                white-space: normal;
            }
        }
    </style>
</head>

<body class="stop-scrolling">
    
    <div id="preloader" style="
        position: fixed; 
        top: 0; left: 0; 
        width: 100%; height: 100%; 
        background-color: #000; 
        z-index: 99999; 
        display: flex; 
        justify-content: center; 
        align-items: center;
    ">
        <div class="preloader-text" style="
            font-family: 'Cascadia Mono ExtraLight', monospace;
            font-size: clamp(20px, 4vw, 40px); 
            color: white; 
            letter-spacing: 5px; 
            text-transform: uppercase;
            opacity: 0; 
        ">
            OLAF M. | PROJEKTY
        </div>
    </div>

    <div id="custom-cursor"></div>

    <div id="transition-overlay"></div> 

    <div class="work-page-container">
        
        <div class="work-header-title">
            OLAF M. | PROJEKTY
            <span class="header-subtitle">graphics designer & web designer</span>
        </div>

        <div class="header-controls">
            <a href="olafmarcinkowski.eu/works.html" class="lang-link">
                <img src="img/use_/lang.png" alt="Język" class="lang-icon" id="lang-icon">
                <span class="lang-text" id="lang-text">EN</span> 
            </a>

            <div class="theme-switch-icons">
                <img src="img/use_/light.png" alt="Tryb Jasny" id="light-icon" class="mode-icon active-mode-icon">
                <img src="img/use_/dark.png" alt="Tryb Ciemny" id="dark-icon" class="mode-icon">
            </div>

            <a href="index.html" class="header-back-link" id="back-link">
                <span>Powrót</span>
            </a>
        </div>
        
        <section class="portfolio-section">
            
            <div class="portfolio-visuals">
                
                <div class="card-stack-wrapper"> 
                    <div class="card-stack">
                        <div class="portfolio-card" data-index="0"><img src="" alt="Podgląd"></div>
                        <div class="portfolio-card" data-index="1"><img src="" alt="Podgląd"></div>
                        <div class="portfolio-card" data-index="2"><img src="" alt="Podgląd"></div>
                        <div class="portfolio-card" data-index="3"><img src="" alt="Podgląd"></div>
                        <div class="portfolio-card" data-index="4"><img src="" alt="Podgląd"></div>
                    </div>
                </div>

            </div>

            <div class="portfolio-info">
                <div class="info-header">
                    <h2 id="info-title" class="info-title"></h2>
                    <span id="info-date" class="info-date"></span>
                </div>
                <p id="info-description-1" class="info-description-1"></p>
                <p id="info-description-2" class="info-description-2"></p>
                
                <a href="https://www.instagram.com/solendz_caravan/" target="_blank" id="read-more-btn" class="nav-btn read-more-link" style="display: none; margin-top: 20px; text-decoration: none;">
                    Więcej
                </a>
                
                <div class="info-counter">
                    <span id="current-index">1</span>/<span id="total-works">8</span>
                </div>

                <div class="portfolio-controls-desktop">
                    <button id="prev-btn-desktop" class="nav-btn">Poprzedni</button>
                    <button id="next-btn-desktop" class="nav-btn">Następny</button>
                </div>
            </div>

        </section>
        
        <div class="portfolio-controls-mobile">
            <button id="prev-btn-mobile" class="nav-btn">Poprzedni</button>
            <button id="next-btn-mobile" class="nav-btn">Następny</button>
        </div>

        <section class="methodology-section">
            <div class="methodology-header">
                <span class="section-label">PROCES</span>
                <h2 class="methodology-title">Cyfrowe Rzemiosło</h2>
            </div>
            <div class="methodology-grid">
                <div class="method-item">
                    <div class="method-number">01</div>
                    <h3 class="method-name">Wstępna Koncepcja</h3>
                    <p class="method-desc">Nie używam szablonów. Każdy projekt zaczynam od czystej kartki, w której logika łączy się z intuicją. Dokładnie analizuję ścieżkę użytkownika, aby stworzyć interfejs, który jest nie tylko funkcjonalny, ale i naturalny w obsłudze.</p>
                </div>
                <div class="method-item">
                    <div class="method-number">02</div>
                    <h3 class="method-name">Wizualizacja Projektu</h3>
                    <p class="method-desc">Dzięki zaawansowanemu retuszowi i tworzeniu własnych zasobów, przekładam abstrakcyjne pomysły na grafikę dopracowaną co do piksela. Moja filozofia równoważy przestrzeń negatywną z siłą typografii, aby naturalnie kierować wzrok użytkownika.</p>
                </div>
                <div class="method-item">
                    <div class="method-number">03</div>
                    <h3 class="method-name">Implementacja Kodu</h3>
                    <p class="method-desc">Piszę własny kod. Zamiast polegać na dużych frameworkach, wybieram natywne rozwiązania (HTML5, WebGL, GSAP), co gwarantuje płynność animacji i maksymalną wydajność. To inżynieria w służbie sztuki.</p>
                </div>
            </div>
            <div class="methodology-footer">
                <p>"Design to nie tylko wygląd. To przede wszystkim odczucia płynące z interakcji z niewidzialną architekturą sieci."</p>
            </div>
        </section>

    </div> 

    <footer class="site-footer">
        <div class="footer-divider"></div>
        <div class="footer-content">
            <div class="footer-container">
                <div class="footer-left">
                    <p class="footer-cta">Chcesz wznieść swoją cyfrową przestrzeń na wyższy poziom? Napisz śmiało - jestem gotów do działania!</p>
                    <p class="copyright">Prawa zastrzeżone 2025 ©</p>
                </div>
                <div class="footer-right">
                    <div class="footer-col">
                        <div class="footer-subject">Nawigacja</div>
                        <a href="PL.html">Start</a>
                        <a href="PL.html">O mnie</a>
                        <a href="wpl.html">Projekty</a>
                    </div>
                    <div class="footer-col">
                        <div class="footer-subject">Kontakt</div>
                        <a href="https://www.instagram.com/solendz_caravan/" target="_blank">@solendz_caravan</a>
                        <a href="mailto:olo.marcinkowski@gmail.com">olo.marcinkowski@gmail.com</a>
                    </div>
                    <div class="footer-col">
                        <div class="footer-subject">Ja</div>
                        <span>Olaf Marcinkowski</span>
                        <span>Grudziądz, 86-300, PL</span>
                        <span style="margin-top: 5px;">projektant graficzny i<br>stron internetowych</span>
                    </div>
                </div>
            </div>
        </div>
    </footer>

<script src="preloader.js"></script>

<script>
    const worksData = [
        { 
            title: "Koncepcja UI i Implementacja Front-Endu", 
            date: "12.03.2025", 
            description1: "Projekt polegał na stworzeniu szczegółowego, niestandardowego mock-upu oraz implementacji front-endu dla profesjonalnej strony internetowej filmowca i reżysera.", 
            description2: "Wszystkie elementy graficzne, układy i komponenty wizualne zostały przeze mnie ręcznie wykonane, tworząc unikalny i oryginalny styl. Dostarczone zdjęcia i materiały wizualne starannie wyretuszowałem i dostosowałem do kierunku artystycznego oraz potrzeb technicznych interfejsu.",
            image: "document1.png" 
        },
        { 
            title: "Prototyp Dynamicznej Strony Głównej", 
            date: "01.03.2025", 
            description1: "Projekt przedstawia dynamiczną stronę główną dla studia filmowego, z obracającą się galerią i płynnymi, kinowymi przejściami i interaktywnym środowiskiem interfejsu użytkownika (UI) działającym w czasie rzeczywistym.", 
            description2: "Mock-up przedstawia również podstawową strukturę front-endu, w tym planowaną logikę interakcji, stany 'hover' oraz przepływ nawigacji. Wszystkie komponenty wizualne zaprojektowano na zamówienie, by pasowały do estetyki studia i wspierały czyste, funkcjonalne doświadczenie użytkownika.",
            image: "document2.gif" 
        },
        { 
            title: "Strona Osobista - Prezentacja", 
            date: "15.02.2025", 
            description1: "Cyfrowy mock-up i demo technologii konwersacyjnej stworzone w celu prezentacji nowoczesnego doświadczenia.", 
            description2: "Cały wizualny szkielet (układ, elementy brandingu i komponenty interfejsu) został w całości zaprojektowany przeze mnie, a wszystkie zdjęcia starannie przygotowane i zoptymalizowane pod kątem płynnego wyświetlania. Prototyp zawiera niestandardową strukturę HTML, logikę interakcji pozwalającą na płynne rozmowy z wirtualnym agentem Jasona oraz dopasowaną stylizację, zapewniającą przejrzystość, responsywność i intuicyjny przepływ użytkownika.",
            image: "document3.png" 
        },
        { 
            title: "Prototyp Portfolio", 
            date: "28.02.2024", 
            description1: "Czyste i minimalistyczne portfolio internetowe, stworzone w celu podkreślenia prac i stylu artystycznego fotografki.", 
            description2: "Cała prezentacja wizualna (struktura układu, typografia i elementy interfejsu) została przeze mnie wykonana, aby podkreślić przejrzystość i stonowaną elegancję. Wszystkie fotografie starannie przygotowałem do użytku internetowego, by zachować detale i zapewnić szybkie ładowanie. Projekt opiera się na lekkiej bazie HTML, subtelnych interakcjach interfejsu i niestandardowej stylizacji, zaprojektowanej tak, by prezentować jej prace w wyrafinowanym, wolnym od zakłóceń środowisku.",
            image: "document4.png" 
        },
        { 
            title: "Prototyp Bloga Społecznościowego", 
            date: "11.01.2025", 
            description1: "Koncepcja strony internetowej zorientowanej na społeczność, zaprojektowana w celu wsparcia projektu renowacyjnego i zapewnienia czystej, łatwej w zarządzaniu platformy blogowej.", 
            description2: "Cała warstwa wizualna (układy, grafika i komponenty interfejsu) została przeze mnie ręcznie wykonana, a wszystkie dostarczone zdjęcia starannie edytowane i zoptymalizowane do użytku internetowego. Projekt obejmował strukturę HTML, funkcjonalność JavaScript dla elementów interaktywnych oraz niestandardową stylizację, aby zapewnić lekkie i responsywne doświadczenie użytkownika.",
            image: "document5.png" 
        },
        { 
            title: "Osobiste Portfolio", 
            date: "17.12.2025", 
            description1: "Kompaktowa prezentacja moich prototypów projektowych, interfejsów i eksperymentów technicznych. Stworzyłem pełną strukturę wizualną strony, utrzymując ją w czystości, lekkości i spójności we wszystkich prezentowanych projektach.", 
            description2: "Jednym z wyróżników jest mój niestandardowy silnik WebGL2. Niebo, ocean i inne elementy są generowane proceduralnie w GLSL. Renderowanie odbywa się na pojedynczym, pełnoekranowym czworokącie, a większość obliczeń jest obsługiwana na GPU, podczas gdy JavaScript zarządza jedynie kamerą i czasem.",
            image: "document6.png" 
        },
        { 
            title: "Morfing Cząsteczek WebGL", 
            date: "20.11.2024", 
            description1: "Interaktywne doświadczenie z cząsteczkami 3D zbudowane w Three.js, w którym tekst i ikony dynamicznie przechodzą (morfią) w różne kształty. Zaprojektowałem pełny interfejs wizualny, utrzymując go w eleganckiej, responsywnej formie i skupiając się na płynnych animacjach.", 
            description2: "Kluczową cechą jest niestandardowy system shaderów cząsteczek. GLSL obsługuje morfing, kolor i interakcje (oparte na myszy) w całości na GPU, podczas gdy JavaScript zarządza celami cząsteczek, synchronizacją animacji i danymi wejściowymi użytkownika.",
            image: "document7.gif" 
        },
        {
            title: "Przytulna przestrzeń wirtualna - Catchin' Club", 
            date: "W produkcji od 05.01.2025", 
            description1: "Catchin' Club to samodzielnie tworzony, relaksujący projekt koncepcyjny anonimowej gry MMO. Gra koncentruje się na interakcjach społecznych, łowieniu ryb i nawiązywaniu znajomości. Wszystkie pikselowe zasoby wizualne zostały osobiście zaprojektowane i stworzone przeze mnie.", 
            description2:"Projekt wykorzystuje zaawansowaną, niestandardową architekturę P2P opartą na WebRTC i bibliotece PeerJS. Cała logika serwera i synchronizacja zarządzana działa poprzez mój oryginalny, dedykowany Game Host Worker, co eliminuje potrzebę tradycyjnej infrastruktury serwerowej.",
            image: "document8.png" 
        }
    ];

    const CARD_COUNT = worksData.length; 
    const TRANSITION_DURATION = 0.8; 
    let isAnimating = false;
    const VISIBLE_LIMIT = 4; 
    const isMobile = window.innerWidth <= 1024; 

    const DESKTOP_PROPS = {
        0: { z: 10, rotationY: -6, scale: 1, x: '0%', opacity: 1, zIndex: 5 },
        1: { z: 5, rotationY: -5, scale: 0.98, x: '2%', opacity: 1, zIndex: 4 },
        2: { z: 4, rotationY: -4, scale: 0.96, x: '4%', opacity: 0.8, zIndex: 3 },
        3: { z: 3, rotationY: -3, scale: 0.94, x: '6%', opacity: 0.4, zIndex: 2 },
        4: { z: 2, rotationY: -2, scale: 0.92, x: '8%', opacity: 0, zIndex: 1 },
    };
    
    const MOBILE_PROPS = {
        0: { z: 10, rotationY: -3, scale: 1, x: '0%', opacity: 1, zIndex: 5 },
        1: { z: 5, rotationY: -2, scale: 0.98, x: '1%', opacity: 1, zIndex: 4 },
        2: { z: 4, rotationY: -1, scale: 0.96, x: '2%', opacity: 0.8, zIndex: 3 },
        3: { z: 3, rotationY: 0, scale: 0.94, x: '3%', opacity: 0.4, zIndex: 2 },
        4: { z: 2, rotationY: 0, scale: 0.92, x: '4%', opacity: 0, zIndex: 1 }, 
    };
    
    const CARD_PROPS = isMobile ? MOBILE_PROPS : DESKTOP_PROPS;


    function updateCardState(cards) {
        cards.forEach((card, index) => {
            const props = CARD_PROPS[index] || CARD_PROPS[VISIBLE_LIMIT]; 
            const workIndex = parseInt(card.dataset.workIndex);
            if(workIndex >= 0 && workIndex < worksData.length) {
                card.querySelector('img').src = `img/work_/${worksData[workIndex].image}`; 
            }
            const finalOpacity = index > VISIBLE_LIMIT ? 0 : props.opacity;
            gsap.to(card, {
                duration: TRANSITION_DURATION,
                x: props.x,
                y: 0, 
                rotationY: props.rotationY,
                scale: props.scale,
                opacity: finalOpacity,
                zIndex: props.zIndex,
                ease: "power3.inOut"
            });
        });
    }

    function initialCardLoadAnimation(cards) {
        cards.forEach((card, index) => {
            const props = CARD_PROPS[index] || CARD_PROPS[VISIBLE_LIMIT];
            card.style.zIndex = props.zIndex;
            const workIndex = parseInt(card.dataset.workIndex);
            if(workIndex >= 0 && workIndex < worksData.length) {
                card.querySelector('img').src = `img/work_/${worksData[workIndex].image}`; 
            }
        });
        
        gsap.set(cards, { x: '-100vw', y: '0%', rotationY: -60, scale: 0.8, opacity: 0, visibility: 'visible' });

        const tl = gsap.timeline({ onComplete: () => { isAnimating = false; } });
        
        for (let i = cards.length - 1; i >= 0; i--) {
            const card = cards[i];
            const props = CARD_PROPS[i] || CARD_PROPS[VISIBLE_LIMIT];
            const finalOpacity = i > VISIBLE_LIMIT ? 0 : props.opacity;
            
            tl.to(card, {
                duration: 1.0, 
                x: props.x,
                y: 0, 
                rotationY: props.rotationY,
                scale: props.scale,
                opacity: finalOpacity,
                ease: "power3.out" 
            }, (cards.length - 1 - i) * 0.08); 
        }
    }

    function updateText(data) {
        const titleEl = document.getElementById('info-title');
        const dateEl = document.getElementById('info-date');
        const desc1El = document.getElementById('info-description-1');
        const desc2El = document.getElementById('info-description-2');
        const readMoreBtn = document.getElementById('read-more-btn'); 

        const isCatchinClub = data.title.includes("Przytulna przestrzeń wirtualna - Catchin' Club"); 
        
        if (readMoreBtn) {
            gsap.set(readMoreBtn, { display: 'none' });
        }


        gsap.to([titleEl, dateEl, desc1El, desc2El], { 
            opacity: 0, filter: 'blur(8px)', duration: TRANSITION_DURATION / 2,
            onComplete: () => {
                titleEl.textContent = data.title;
                dateEl.textContent = data.date;
                desc1El.textContent = data.description1;
                desc2El.textContent = data.description2;
                
                if (readMoreBtn && isCatchinClub) {
                    gsap.set(readMoreBtn, { opacity: 0, display: 'inline-block' });
                }

                gsap.to([titleEl, dateEl, desc1El, desc2El], { 
                    opacity: 1, filter: 'blur(0px)', duration: TRANSITION_DURATION / 2, delay: 0.1, ease: "power3.out"
                });
                
                if (readMoreBtn && isCatchinClub) {
                    gsap.to(readMoreBtn, { 
                        opacity: 1, duration: TRANSITION_DURATION / 2, delay: 0.1, ease: "power3.out"
                    });
                }
            }
        });
    }

    function handleTransition(direction) {
        if (isAnimating) return;
        isAnimating = true;

        const cards = Array.from(document.querySelectorAll('.portfolio-card'));
        const firstCard = cards[0];
        const cardStack = document.querySelector('.card-stack');

        const currentWorkIndex = parseInt(firstCard.dataset.workIndex);
        
        const currentBottomCardIndex = parseInt(cards[cards.length - 1].dataset.workIndex);
        
        const textUpdateIndex = (currentWorkIndex + 1) % worksData.length;
        const newBottomCardIndex = (currentBottomCardIndex + 1) % worksData.length;

        const prevWorkIndex = (currentWorkIndex - 1 + worksData.length) % worksData.length;

        if (direction === 'next') {
            gsap.to(firstCard, {
                x: isMobile ? '-100%' : '-110%', rotationY: -10, scale: 1.1, opacity: 0, duration: TRANSITION_DURATION, ease: "power2.in",
                onComplete: () => {
                    firstCard.dataset.workIndex = newBottomCardIndex; 
                    
                    cardStack.appendChild(firstCard);
                    const lastProps = CARD_PROPS[VISIBLE_LIMIT];
                    gsap.set(firstCard, { x: lastProps.x, rotationY: lastProps.rotationY, scale: lastProps.scale, opacity: 0, zIndex: lastProps.zIndex });
                    updateCardState(Array.from(document.querySelectorAll('.portfolio-card')));
                    isAnimating = false;
                }
            });
            updateText(worksData[textUpdateIndex]); 
            const currentIndexEl = document.getElementById('current-index');
            let currentNum = parseInt(currentIndexEl.textContent);
            currentNum = (currentNum % CARD_COUNT) + 1;
            currentIndexEl.textContent = currentNum;

        } else if (direction === 'prev') {
            const lastCard = cards[cards.length - 1]; 
            lastCard.dataset.workIndex = prevWorkIndex; 
            gsap.set(lastCard, { x: isMobile ? '-150%' : '-150%', rotationY: -45, scale: 0.8, opacity: 0, zIndex: 10 });
            cards.forEach((card, index) => {
                 const nextProps = CARD_PROPS[index+1] || CARD_PROPS[VISIBLE_LIMIT];
                 gsap.set(card, { zIndex: nextProps ? nextProps.zIndex : 0 });
            });
            cardStack.prepend(lastCard);
            updateCardState(Array.from(document.querySelectorAll('.portfolio-card'))); 
            updateText(worksData[prevWorkIndex]);
            const currentIndexEl = document.getElementById('current-index');
            let currentNum = parseInt(currentIndexEl.textContent);
            currentNum = (currentNum - 2 + CARD_COUNT) % CARD_COUNT + 1;
            currentIndexEl.textContent = currentNum;
            gsap.delayedCall(TRANSITION_DURATION, () => { isAnimating = false; });
        }
    }

    function toggleTheme() {
        const body = document.body;
        const overlay = document.getElementById('transition-overlay');
        const lightIcon = document.getElementById('light-icon');
        const darkIcon = document.getElementById('dark-icon');
        gsap.set(overlay, { visibility: 'visible', pointerEvents: 'all', opacity: body.classList.contains('light-mode-active') ? 0 : 1 });
        gsap.to(overlay, {
            opacity: body.classList.contains('light-mode-active') ? 1 : 0, duration: 0.4, ease: "power2.in", 
            onComplete: () => {
                body.classList.toggle('light-mode-active');
                overlay.style.backgroundColor = body.classList.contains('light-mode-active') ? '#fcfcfc' : '#000';
                lightIcon.classList.toggle('active-mode-icon');
                darkIcon.classList.toggle('active-mode-icon');
                gsap.to(overlay, { opacity: 0, duration: 0.4, ease: "power2.out", onComplete: () => {
                    gsap.set(overlay, { visibility: 'hidden', pointerEvents: 'none' });
                }});
            }
        });
    }

    document.addEventListener("DOMContentLoaded", function() {
        if (history.scrollRestoration) { history.scrollRestoration = 'manual'; }
        window.scrollTo(0, 0);

        const cursor = document.getElementById('custom-cursor');
        const overlay = document.getElementById('transition-overlay');
        const body = document.body;
        
        const transitionLinks = document.querySelectorAll('.header-back-link, .footer-col a, .lang-link');
        
        isAnimating = true; 

        if (overlay) {
            gsap.to(overlay, { opacity: 0, duration: 1.2, ease: "power2.out", onComplete: () => {
                gsap.set(overlay, { visibility: 'hidden', pointerEvents: 'none' });
            }});
        }
        
        if (transitionLinks.length > 0 && overlay) {
            transitionLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    const targetUrl = this.getAttribute('href');
                    
                    if(targetUrl === '#' || targetUrl.startsWith('javascript')) return;

                    if (this.id === 'read-more-btn') return;

                    e.preventDefault(); 
                    
                    gsap.set(overlay, { visibility: 'visible', pointerEvents: 'all', opacity: 0, backgroundColor: '#000' });
                    
                    gsap.to(overlay, { 
                        opacity: 1, 
                        duration: 0.8, 
                        ease: "power2.in", 
                        onComplete: () => { 
                            window.location.href = targetUrl; 
                        }
                    });
                });
            });
        }
        
        let mouseX = 0, mouseY = 0, cursorX = 0, cursorY = 0;
        const speed = 0.15; 
        if (cursor) {
            document.addEventListener('mousemove', function(e) { mouseX = e.clientX; mouseY = e.clientY; });
            function animateCursor() {
                cursorX += (mouseX - cursorX) * speed;
                cursorY += (mouseY - cursorY) * speed;
                cursor.style.left = cursorX + 'px'; cursor.style.top = cursorY + 'px';
                requestAnimationFrame(animateCursor);
            }
            animateCursor();
            document.addEventListener('mousedown', () => cursor.classList.add('click-active'));
            document.addEventListener('mouseup', () => cursor.classList.remove('click-active'));
            const links = document.querySelectorAll('a, button, .header-back-link, input, .nav-btn, .lang-link, .mode-icon, .footer-col a');
            links.forEach(link => {
                link.addEventListener('mouseenter', () => cursor.classList.add('hover-active'));
                link.addEventListener('mouseleave', () => cursor.classList.remove('hover-active'));
            });
        }
        
        const cardStack = document.querySelector('.card-stack');
        const nextBtnDesktop = document.getElementById('next-btn-desktop');
        const prevBtnDesktop = document.getElementById('prev-btn-desktop');
        const nextBtnMobile = document.getElementById('next-btn-mobile');
        const prevBtnMobile = document.getElementById('prev-btn-mobile');
        const totalWorksEl = document.getElementById('total-works');
        const lightIcon = document.getElementById('light-icon');
        const darkIcon = document.getElementById('dark-icon');
        
        if (lightIcon && darkIcon) {
            lightIcon.addEventListener('click', toggleTheme);
            darkIcon.addEventListener('click', toggleTheme);
        }

        if (cardStack) {
            while (cardStack.children.length < 5) {
                const newCard = document.createElement('div');
                newCard.classList.add('portfolio-card');
                const img = document.createElement('img'); img.alt = "Podgląd Dokumentu";
                newCard.appendChild(img); cardStack.appendChild(newCard);
            }
            const cards = Array.from(document.querySelectorAll('.portfolio-card'));
            cards.forEach((card, index) => { card.dataset.workIndex = index; });
            gsap.set(cards, { x: '-100vw', opacity: 0 });
            updateText(worksData[0]); 
            totalWorksEl.textContent = CARD_COUNT; 

            if(nextBtnDesktop) nextBtnDesktop.addEventListener('click', () => handleTransition('next'));
            if(prevBtnDesktop) prevBtnDesktop.addEventListener('click', () => handleTransition('prev'));
            if(nextBtnMobile) nextBtnMobile.addEventListener('click', () => handleTransition('next'));
            if(prevBtnMobile) prevBtnMobile.addEventListener('click', () => handleTransition('prev'));

            cards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    if (this === document.querySelector('.card-stack').children[0] && !isAnimating) {
                        gsap.to(this, { duration: 0.3, scale: 1.01, rotationY: isMobile ? -1 : -1.5, ease: "power2.out" });
                    }
                });
                card.addEventListener('mouseleave', function() {
                    if (this === document.querySelector('.card-stack').children[0] && !isAnimating) {
                         const originalProps = CARD_PROPS[0];
                         gsap.to(this, { duration: 0.3, scale: originalProps.scale, rotationY: originalProps.rotationY, ease: "power2.out" });
                    }
                });
            });

            const preloader = document.getElementById('preloader');
            if (preloader) {
                const observer = new MutationObserver(function(mutations) {
                    mutations.forEach(function(mutation) {
                        if (mutation.type === "attributes" && mutation.attributeName === "style") {
                            const style = window.getComputedStyle(preloader);
                            if (parseFloat(style.opacity) < 0.9 || style.display === 'none') {
                                document.body.classList.remove('stop-scrolling');
                                initialCardLoadAnimation(cards); 
                                observer.disconnect();
                            }
                        }
                    });
                });
                observer.observe(preloader, { attributes: true });
            } else {
                document.body.classList.remove('stop-scrolling');
                initialCardLoadAnimation(cards);
            }
        }
    });
</script>

</body>
</html>